
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Parser for CP2K basis sets and GTH pseudopotentials, and a webserver to find matching basis and pseudo for your calculations.">
      
      
      
        <link rel="canonical" href="https://pierre-24.github.io/cp2k-basis/basis_sets_and_pseudos/">
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.4.2, mkdocs-material-8.5.10">
    
    
      
        <title>On basis sets and GTH pseudopotentials in CP2K - cp2k-basis</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.975780f9.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.2505c338.min.css">
        
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="None" data-md-color-accent="None">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#on-basis-sets-and-gth-pseudopotentials-in-cp2k" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="cp2k-basis" class="md-header__button md-logo" aria-label="cp2k-basis" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            cp2k-basis
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              On basis sets and GTH pseudopotentials in CP2K
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/pierre-24/cp2k-basis" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    pierre-24/cp2k-basis
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="cp2k-basis" class="md-nav__button md-logo" aria-label="cp2k-basis" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    cp2k-basis
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/pierre-24/cp2k-basis" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    pierre-24/cp2k-basis
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../about/" class="md-nav__link">
        About
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          For the users
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="For the users" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          For the users
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          On basis sets and GTH pseudopotentials in CP2K
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        On basis sets and GTH pseudopotentials in CP2K
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#basis-sets" class="md-nav__link">
    Basis sets
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gth-pseudopotentials" class="md-nav__link">
    GTH pseudopotentials
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pairing-gth-pseudopotentials-with-basis-sets" class="md-nav__link">
    Pairing GTH pseudopotentials with basis sets
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../webserver/" class="md-nav__link">
        Using the web interface
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../api/" class="md-nav__link">
        REST API reference
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          For the developers
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="For the developers" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          For the developers
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../install/" class="md-nav__link">
        Install and contribute
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../library_build/" class="md-nav__link">
        Build, use and improve the library
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../library_file_format/" class="md-nav__link">
        Library file format
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#basis-sets" class="md-nav__link">
    Basis sets
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gth-pseudopotentials" class="md-nav__link">
    GTH pseudopotentials
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pairing-gth-pseudopotentials-with-basis-sets" class="md-nav__link">
    Pairing GTH pseudopotentials with basis sets
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  <a href="https://github.com/pierre-24/cp2k-basis/blob/master/docs/basis_sets_and_pseudos.md" title="Edit this page" class="md-content__button md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25Z"/></svg>
  </a>


<h1 id="on-basis-sets-and-gth-pseudopotentials-in-cp2k">On basis sets and GTH pseudopotentials in CP2K<a class="headerlink" href="#on-basis-sets-and-gth-pseudopotentials-in-cp2k" title="Permanent link">¤</a></h1>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>For the latest CP2K review, see <a href="https://dx.doi.org/10.1063/5.0007045">10.1063/5.0007045</a> (May 2020).</p>
</div>
<h2 id="basis-sets">Basis sets<a class="headerlink" href="#basis-sets" title="Permanent link">¤</a></h2>
<p>Solving the Schrödinger equation generally resort to the use of the LCAO (<em>linear combination of atomic orbitals</em>) approximation.
For computational reasons, while STO (slater-type orbitals, <span class="arithmatex">\(\propto e^{r}\)</span>) should be used, GTO (gaussian type orbitals, <span class="arithmatex">\(\propto e^{r^2}\)</span>) are preferred.</p>
<p>In CP2K (as in other quantum chemistry programs), <strong>basis functions</strong> (i.e., atomic orbitals) are defined as:</p>
<div class="arithmatex">\[\psi_{i,\ell m} (\mathbf r) = R_{i,\ell}(\mathbf r)\,Y_{\ell m}(\theta,\phi),\]</div>
<p>where <span class="arithmatex">\(R(r)\)</span> is the radial part, and <span class="arithmatex">\(Y_{\ell m}\)</span> is a <a href="https://en.wikipedia.org/wiki/Spherical_harmonics">spherical harmonic</a> (<span class="arithmatex">\(\ell\)</span> is the angular momentum and <span class="arithmatex">\(m\in[-\ell,\ell]\)</span>) for the angular part.
A weighted sum of <strong>primitives</strong> (Gaussian functions) is used for this part:</p>
<div class="arithmatex">\[R_{i,\ell}(r) = r^\ell\,\sum_{j} c_{ij}\,e^{-\alpha_j\,r^2},\]</div>
<p>where <span class="arithmatex">\(\alpha_{j}\)</span> is the <strong>exponent</strong>, while <span class="arithmatex">\(c_{ij}\)</span> is the corresponding <strong>contraction coefficient</strong>. 
The two numbers defines the primitive <span class="arithmatex">\(j\)</span> in the basis function <span class="arithmatex">\(\psi_i\)</span>.</p>
<p>Thus, a basis sets is a library of contractions for each shell (s-type [<span class="arithmatex">\(\ell=0\)</span>], p-type [<span class="arithmatex">\(\ell=1\)</span>], d-type [<span class="arithmatex">\(\ell=2\)</span>], etc) of a given atom, containing the definition of the primitives (so a list of exponents and their corresponding contraction coefficients).
Since the radial part is the same for each possible orbital in a shell (i.e., each possible value of <span class="arithmatex">\(m\)</span>), this is sufficient to define a basis set.</p>
<div class="admonition note">
<p class="admonition-title">But basis function can be grouped!</p>
<p>Some basis functions (even with different <span class="arithmatex">\(\ell\)</span>) may be grouped to share the same exponent. </p>
<p>This is the case, e.g., in the (in)famous STO-3G (3 gaussians for each basis function) in which so-called "SP" basis functions are found, defined by using a common exponent but different contraction coefficient for each of the 3 gaussians defining the actual s-type and p-type basis function.</p>
<p>MOLOPT basis sets (see below) are built on this principle.</p>
</div>
<p>Multiple-<span class="arithmatex">\(\zeta\)</span> basis sets use <span class="arithmatex">\(\zeta\)</span> basis functions for each atomic orbitals in the atom. 
For example, double-<span class="arithmatex">\(\zeta\)</span> basis sets use two basis function for each atomic orbital (e.g., a total of 10 basis function for the carbon).
They may be grouped to share the same exponent, or not.</p>
<p>On top of that, two other kind of basis function might be added:</p>
<ol>
<li><em>polarization functions</em>, which have a larger angular momentum than those of the ground state of the atom (e.g., d-type basis functions for the carbon), and</li>
<li><em>diffuse functions</em>, which have very small exponents (corresponding to very "large" Gaussian functions).</li>
</ol>
<p>Thus, the number of basis function for a given atom is very different from one basis set to the other.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>One way to ease the communication is to report, for each shell, the number of primitives (uncontracted set) in the form <code>(uncontracted set)</code>, and the number of basis functions (contracted set) in the form <code>[contracted set]</code>.</p>
<p>For example, in a double-zeta basis set defined by 3 gaussian per basis function, the result for carbn would be <code>(12s,6p)</code> and <code>[3s,2p]</code>. 
The form <code>[12s6p|3s2p]</code>, combining the two is also found.</p>
</div>
<p>However, for reasons that will become clear in the next section, CP2K does not only use all-electron basis sets.</p>
<h2 id="gth-pseudopotentials">GTH pseudopotentials<a class="headerlink" href="#gth-pseudopotentials" title="Permanent link">¤</a></h2>
<p>Indeed, CP2K notoriously use an auxiliary plane wave (PW) basis set to perform its calculation with the GPW and GAPW methods.
To perform a PW calculation, one needs to include all possible basis sets below a given threshold. 
Increasing this threshold will monotonously improve the quality of the result (and the length of the calculation!).
However, area where the electron density is rapidly changing requires PW with small wavelengths/high energy to be well described (i.e., large Fourier components), so high threshold, which would make the calculation impossible in practice.</p>
<p>But the area where such changes are important are mostly located near the nuclei, "thanks" its ionic potential <span class="arithmatex">\(V(r) = - \frac{Z}{r}\)</span>.
Hopefully, core and valence shell are generally well (spatially and energetically) separated, and core electrons are relatively unperturbed by the surrounding (chemically inert).</p>
<p>So the idea behind <a href="https://en.wikipedia.org/wiki/Pseudopotential">pseudopotentials</a> is to replace the effect of the nuclei and the core electrons (which are considered <em>frozen</em>) by an effective potential (below a given threshold <span class="arithmatex">\(r_c\)</span>), and the valence electrons basis functions by ones with fewer nodes (since they do not need to be orthogonal to the, now removed, valence orbital), but with the same behavior outside the core region (for <span class="arithmatex">\(r &gt; r_c\)</span>).</p>
<details class="example">
<summary>Derivation of a pseudopotential</summary>
<p>Say one has a set of (orthogonal) core states <span class="arithmatex">\(\{|\chi_n\rangle\}\)</span> (with their corresponding eigenvalue <span class="arithmatex">\(\{E_n\}\)</span>).
The goal is to construct a pseudo-state <span class="arithmatex">\(|\phi\rangle\)</span> for a valence state <span class="arithmatex">\(|\psi\rangle\)</span> (with its corresponding eigenvalue <span class="arithmatex">\(E\)</span>), in the form:</p>
<div class="arithmatex">\[|\psi\rangle = |\phi\rangle + \sum a_n |\chi_n\rangle.\]</div>
<p>Since the core and valence state must be orthogonal, <span class="arithmatex">\(\langle \chi_m | \psi \rangle = 0 = \langle \chi_m | \phi \rangle + a_m\)</span>, so that</p>
<div class="arithmatex">\[|\psi\rangle = |\phi\rangle - \sum |\chi_n\rangle \langle \chi_n | \phi\rangle.\]</div>
<p>Substituting in Schrödinger equation for <span class="arithmatex">\(|\psi\rangle\)</span> gives</p>
<div class="arithmatex">\[\hat H |\phi\rangle + \sum (E-E_n) |\chi_n\rangle \langle \chi_n | \phi\rangle = E|\phi\rangle.\]</div>
<p>The pseudo-state thus obeys <span class="arithmatex">\([\hat H + \hat V_{n\ell}]\, |\phi\rangle = E\,|\phi\rangle\)</span> with:</p>
<div class="arithmatex">\[\hat V_{n\ell} = \sum_n (E-E_n)\,|\chi_n\rangle \langle \chi_n |.\]</div>
<p>where the energy of <span class="arithmatex">\(|\phi\rangle\)</span> is the same as the one of <span class="arithmatex">\(|\psi\rangle\)</span>, thanks to the pseudopotential <span class="arithmatex">\(\hat V_{n\ell}\)</span>.
This extra potential depends on <span class="arithmatex">\(\ell\)</span> due to its spherical symmetry.
Furthermore, since <span class="arithmatex">\(E &gt; E_n\)</span>, it is a repulsive potenial.</p>
</details>
<p>In practice, pseudopotential expressions are separated into a fully nonlocal form, thanks to the Kleinman-Bylander Transformation (see <a href="https://dx.doi.org/10.1103/PhysRevLett.48.1425">10.1103/PhysRevLett.48.1425</a>).
Latter on, Goedecker, Teter and Hutter (GTH, see <a href="https://dx.doi.org/10.1103/PhysRevB.54.1703">10.1103/PhysRevB.54.1703</a>) derived expressions those two parts which are suited for real and Fourier space integration and only requires a few adjustable parameters (in blue):</p>
<div class="arithmatex">\[\hat V_{PP} = \hat V_{loc} +  \sum_{\ell}^{\textcolor{blue}{\ell_{max}}}\sum_{ij}^{\textcolor{blue}{N}} \textcolor{blue}{h_{\ell,ij}} \,|p_{\ell,i}\rangle \langle p_{\ell,j}|,\]</div>
<p>with</p>
<div class="arithmatex">\[V_{loc}(r) = -\frac{Z'}{r}\,\text{erf}\left[\frac{\bar r}{\sqrt 2}\right] + \exp\left[-\frac{\bar r^2}{2}\right] \sum_{i=1}^4 \textcolor{blue}{C_i}\,\bar r^{2i-2}, \text{ with } \bar r = \frac{r}{\textcolor{blue}{r_c}},\]</div>
<p>and </p>
<div class="arithmatex">\[p_{\ell,i}(r) = N_{\ell,i}(r)\,\exp\left[-\frac{\bar r^2}{2}\right], \text{ with } \bar r = \frac{r}{\textcolor{blue}{r_{nl,\ell}}}.\]</div>
<p>In the former, <span class="arithmatex">\(Z'\)</span> is the ionic charge (i.e., the charge of the nucleus minus the one of the core electrons), while in the latter, <span class="arithmatex">\(N_\ell(r)\)</span> is a combination of spherical harmonic multiplied by a <span class="arithmatex">\(\ell\)</span>-dependent radial function.</p>
<p>All the parameters in blue, together with the number of core electrons in each shell, <strong>define a GTH pseudopotential</strong> in CP2K (see, e.g., <a href="https://dx.doi.org/10.1007/s00214-005-0655-y">10.1007/s00214-005-0655-y</a>).</p>
<h2 id="pairing-gth-pseudopotentials-with-basis-sets">Pairing GTH pseudopotentials with basis sets<a class="headerlink" href="#pairing-gth-pseudopotentials-with-basis-sets" title="Permanent link">¤</a></h2>
<p>From the previous paragraph, it appears that one has to pair a given pseudopotential with a correctly defined basis set, that contains smooth (pseudo-) basis functions.</p>
<p>To be continued, but:</p>
<ul>
<li>Present the naming rule(s) of basis sets and pseudopontials;</li>
<li>Try to indicate which basis set goes with witch potential.</li>
<li>Parser?</li>
</ul>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
    <nav class="md-footer__inner md-grid" aria-label="Footer" >
      
        
        <a href="../about/" class="md-footer__link md-footer__link--prev" aria-label="Previous: About" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              About
            </div>
          </div>
        </a>
      
      
        
        <a href="../webserver/" class="md-footer__link md-footer__link--next" aria-label="Next: Using the web interface" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Using the web interface
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.16e2a7d4.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.5a2dcb6a.min.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.js"></script>
      
        <script src="../do-katex.js"></script>
      
    
    
  </body>
</html>